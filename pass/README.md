## 忘记密码的烦恼

密码越来越多，记性越来越来越差，经常被忘记密码烦恼。
不是有很多工具可用了吗？
是的， 有很多管理密码的软件声称自己很安全，但我还是保持警惕的态度，毕竟数据泄露的事件在当今并不罕见。
今天办公室里一大批人又在抱怨了， ERP系统隔一段时间就强制要求更改密码，数不清的密码真的让人很头疼。
但是，一个老牌程序员的脑壳不能白疼，今天我就来动手撸一个自己密码神器。

先回忆一下，我能记住什么吧，苍老师的美貌，各种小黄段子，抖音视频... 打住了，总还有些别的，是的我能记住歌词，诗句，纪念日，成语，名人语录等。都是些朗朗上口的词句， 不是该死的什么1234AbCd!@#$，偏偏电脑系统总是傻傻的， 不懂得”关关雎鸠“的口令下句是”在河之洲“， 或者”龙门飞甲“要答”便知真假“，它只认数字、字母和一些怪符号。

那是不是可以想一个办法，把记得住的“人话”，转成电脑看得懂的“鸟语” ？

用狄大人的话说， 让我想想， 好好的想一想。 一炷香的工夫之后狄公微微一笑，于是有了下面的情节。

## 一种用任意文字生成密码的方法

回顾一下我们需要密码的要求，依次从简单到复杂：

- 纯数字密码，一般是6位。
- 一般要求最少8位密码，包含数字+字母。
- 复杂的要求最少8位密码，包含数字+字母+特殊字符。
- 变态级除以上要求，要求数字不能连续，不能重复。

基于这个实际情况，那我一次性生成三种强度的密码就足够了：
| 密码等级 | 构成                                        | 位数 |
| -------- | ------------------------------------------- | ---- |
| 数字密码 | 6位数字                                     | 6    |
| 一般强度 | 依次：6位数字+1小写字母+1大写字母+1特殊字符 | 9    |
| 复杂密码 | 穿插：6位数字+1小写字母+1大写字母+1特殊字符 | 9    |

据我的经验，一般密码就可以满足**99%**以上的密码强度要求， 复杂密码应该可以满足**99.9%**的要求，连我都没用过。

### 1. 生成MD5值

首先把输入的文字转成MD5值。我们知道MD5算法是安全的，是不可逆的，除非知道原文，否则不可能进行反推。这是整个密码生成算法安全性的基石。

**生成密码的字符集**

| 类型           | 个数 | 字符表                  |
| -------------- | ---- | ----------------------- |
| 数字           | 10   | 0~9                     |
| 字母（大小写） | 23   | abcdefghijkmnpqrstuvwxy |
| 特殊           | 8    | !@#$%^&*                |

### 2. 生成6位数字。

依次从MD5中取出两位， 取出末尾数值d，加入当前数字串中。为提高安全性，要求生成串中：

- 不能含有对子，例如55， 33。显然不会有三连。
- 不能含有顺子，例如 234， 543
- 不能含有重复串，例如 7474

当发生冲突时，需要替换成其他数字， 这里采用伪随机算法来生成替代数字，以当前数字为种子计算下一随机值。伪随机算法是决定式算法，因此序列完全由种子决定。

### 3. 生成其它字符
同样的方法，取出MD5串中剩下的两位，映射到字母集中（去掉了olz不易与数字区分）。特殊字符也用同样方法生成。



### 密码强度分析

总密码空间大小（忽略一些简单数字）$ \approx 10^6×23^2×8=4.23×10^9$，四个多亿，够用。



